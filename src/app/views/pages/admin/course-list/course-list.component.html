<div class="container mt-5 pt-5">

  <!-- Section Heading -->
  <div class="mb-4">
    <h5 class="fw-semibold">Course Management</h5>
    <p class="text-muted" style="font-size: 14px;">View, filter, approve, and manage courses</p>
  </div>

  <!-- Filters -->
  <div class="card border-0 shadow-sm rounded-4 mb-4">
    <div class="card-body">
      <form (ngSubmit)="applyFilter()" #filterForm="ngForm">
        <div class="row g-3">

          <!-- Category -->
          <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <label class="form-label small fw-semibold">Category</label>
            <select class="form-select form-select-sm"
                    [(ngModel)]="selectedFilters.selectedCategories" name="category">
              <option value="">All Categories</option>
              <option *ngFor="let category of courseCategories" [value]="category">{{ category }}</option>
            </select>
          </div>

          <!-- Status -->
          <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <label class="form-label small fw-semibold">Status</label>
            <select class="form-select form-select-sm"
                    [(ngModel)]="selectedFilters.selectedStatuses" name="status">
              <option value="">All Statuses</option>
              <option *ngFor="let status of courseStatuses" [value]="status">{{ status }}</option>
            </select>
          </div>

          <!-- Buttons -->
          <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex gap-2 align-items-end">
            <button type="submit" class="btn btn-primary btn-sm flex-fill">Apply</button>
            <button type="button" class="btn btn-outline-secondary btn-sm flex-fill" (click)="resetFilter()">Reset</button>
          </div>

        </div>
      </form>
    </div>
  </div>

  <!-- Courses Grid -->
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    <div class="col" *ngFor="let course of paginatedCourses">
      <div class="card shadow-sm rounded-3 h-100 border border-dark">
        <div class="card-body">

          <!-- Top: Thumbnail + Title -->
          <div class="d-flex align-items-center mb-3">
            <img *ngIf="course.courseThumbnail" [src]="course.courseThumbnail"
                 alt="Course Thumbnail"
                 class="rounded border me-3"
                 style="width:80px; height:60px; object-fit:cover; background:#fff;">
            <div>
              <div class="d-flex align-items-center gap-2 flex-wrap">
                <strong>{{ course.courseTitle }}</strong>
                <span class="badge"
                      [ngClass]="{
                        'bg-warning text-dark': course.status === 'Pending',
                        'bg-success': course.status === 'Published',
                        'bg-secondary': course.status === 'Draft',
                        'bg-danger': course.status === 'Rejected'
                      }">
                  {{ course.status }}
                </span>
              </div>
              <div class="text-muted small">{{ course.courseCategory }}</div>
            </div>
          </div>

          <!-- Created By -->
          <div class="mb-2" style="font-size: 14px;">
            <strong>Instructor:</strong> {{ course.createdBy.name }} <br>
            <strong>Email:</strong> {{ course.createdBy.email }}
          </div>

          <!-- Description -->
          <div class="text-muted small mb-3" [innerHTML]="course.courseDescription"></div>

          <!-- Actions -->
          <div class="d-flex justify-content-start flex-wrap gap-2">
            <button *ngIf="course.status === 'Pending'" class="btn btn-sm btn-outline-success" (click)="approveCourse(course)">
              <i class="bi bi-check-circle me-1 small"></i> Approve
            </button>
            <button *ngIf="course.status === 'Pending'" class="btn btn-sm btn-outline-danger" (click)="rejectCourse(course)">
              <i class="bi bi-x-circle me-1 small"></i> Reject
            </button>
            <button class="btn btn-sm btn-primary" (click)="viewCourseDetails(course)">
              <i class="bi bi-eye me-1 small"></i> View
            </button>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="d-flex align-items-center mt-5 mb-5 border rounded-4 shadow-sm bg-white flex-nowrap flex-wrap">
    <!-- Left: Items per page -->
    <div class="d-flex align-items-center flex-shrink-0 me-3" style="min-width: 100px;">
      <label for="itemsPerPage" class="me-2 mb-0" style="white-space: nowrap;">Show</label>
      <select id="itemsPerPage" [(ngModel)]="itemsPerPage" (change)="updatePagination()"
              class="form-select form-select-sm" style="min-width: 50px; max-width: 70px;">
        <option *ngFor="let size of [5,10,20,50]" [value]="size">{{ size }}</option>
      </select>
    </div>

    <!-- Center: Pagination -->
    <div class="flex-grow-1 d-flex justify-content-center overflow-auto">
      <ul class="pagination pagination-sm m-0 flex-nowrap">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link" (click)="onPageChange(currentPage - 1)" href="javascript:void(0)">&laquo;</a>
        </li>
        <li *ngFor="let page of pageNumbers" class="page-item" [class.active]="page === currentPage">
          <a class="page-link" (click)="onPageChange(page)" href="javascript:void(0)">{{ page }}</a>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <a class="page-link" (click)="onPageChange(currentPage + 1)" href="javascript:void(0)">&raquo;</a>
        </li>
      </ul>
    </div>

    <!-- Right: Current page info -->
    <div class="flex-shrink-0 ms-3" style="min-width: 120px; text-align: right;">
      <small class="text-muted">Page {{ currentPage }} of {{ totalPages }}</small>
    </div>
  </div>

</div>
